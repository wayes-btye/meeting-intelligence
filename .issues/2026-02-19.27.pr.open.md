# [\#27 PR](https://github.com/wayes-btye/meeting-intelligence/pull/27) `open`: fix: settings, API keys, UI field names â€” core flow now working

#### <img src="https://avatars.githubusercontent.com/u/151667361?v=4" width="50">[wayes-btye](https://github.com/wayes-btye) opened issue at [2026-02-19 00:48](https://github.com/wayes-btye/meeting-intelligence/pull/27):

## Summary

This PR fixes the issues discovered during manual end-to-end testing. Before this PR,
**no API endpoint that touched Supabase or external APIs actually worked** when running
locally with a `.env` file.

### Root cause

All SDK clients (`Supabase`, `Anthropic`, `OpenAI`) were constructed using `os.getenv()`
or with no arguments (relying on env vars). On Windows, `.env` files are NOT loaded into
`os.environ` automatically â€” the Pydantic `Settings` object handles this, but the code
wasn't using it consistently.

### Fixes

**Commit 1: Supabase client**
- `src/ingestion/storage.py` â€” replaced `os.getenv("SUPABASE_URL")` with `settings.supabase_url`
- This was causing 500 errors on every endpoint that touches the database (upload, query, meetings list)

**Commit 2: Anthropic and OpenAI clients**
- `src/retrieval/generation.py` â€” `Anthropic(api_key=settings.anthropic_api_key)` instead of `Anthropic()`
- `src/retrieval/search.py` â€” `OpenAI(api_key=settings.openai_api_key)` instead of `OpenAI()`
- `src/ingestion/embeddings.py` â€” same fix for the embeddings client
- Verified no remaining bare `Anthropic()` or `OpenAI()` calls exist anywhere in `src/`

**Commit 3: UI field name mismatches + documentation**
- Meetings page: `date` â†’ `created_at`, `num_chunks` â†’ `chunk_count`
- Extracted items: `owner` â†’ `assignee`, `text` â†’ `content`, flat list with `item_type` filter
- Sources display: shows speaker + similarity instead of "Unknown meeting"
- Added `docs/manual-testing-guide.md`, `docs/how-it-works.md`, `docs/understanding-the-system.md`

### What was verified manually
- Upload transcript via Streamlit â†’ 200 OK, meeting + chunks stored in Supabase âœ“
- Same transcript uploaded with naive (1 chunk) and speaker_turn (8 chunks) strategies âœ“
- Query with meeting filter â†’ semantic search finds relevant chunks â†’ Claude generates answer with citations âœ“
- Meetings page now shows correct dates, chunk counts, and speaker counts âœ“

### What this PR does NOT fix (tracked separately)
- Audio upload still crashes (Issue #22)
- Evaluation runner has no entry point (Issue #23)
- Duplicate GET extract endpoint (Issue #25)
- MeetingBank data not loaded (Issue #26)

## Test plan
- [x] `pytest tests/ -x` â€” 108 passed
- [x] `ruff check src/` â€” clean
- [x] Manual: upload â†’ query â†’ answer with sources â€” full flow verified

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)




-------------------------------------------------------------------------------



[Export of Github issue for [wayes-btye/meeting-intelligence](https://github.com/wayes-btye/meeting-intelligence). Generated on 2026.02.19 at 22:55:17.]
